---
title: scraping data from wiki to analyze olympic medal
author: Geebbon
date: '2018-03-24'
slug: scraping-data-from-wiki-to-analyze-olympic-medal
categories:
  - web
tags:
  - R
  - web
summary:
  "Learn Edwin Thoen from R-blogger"
---



<p>Today I learn Edwin Thoen from R-blogger. The topic is how to scrape the data from wikepedia and tidy the data in a format in which they can be analyzed. Thank Edwin for sharing the code.</p>
<ul>
<li>scrape data from website</li>
</ul>
<p>I use <code>rvest</code> and <code>tidy</code> package.</p>
<pre class="r"><code>library(&quot;rvest&quot;)
library(tidyverse)
library(stringr)
Olympics_2018_wiki &lt;- read_html(&quot;https://en.wikipedia.org/wiki/List_of_2018_Winter_Olympics_medal_winners&quot;)
sports &lt;- html_nodes(Olympics_2018_wiki, &quot;h2&quot;) %&gt;% html_text()
sports %&gt;% head(3)</code></pre>
<pre><code>## [1] &quot;Alpine skiing[edit]&quot; &quot;Biathlon[edit]&quot;      &quot;Bobsleigh[edit]&quot;</code></pre>
<p><code>html_text</code> is used to convert the <code>xml</code> nodes to regular R characters. I get 18 strings, first 15 elements contain the sport’s names with “edit”, next step is to remove “edit” parts.</p>
<pre class="r"><code>sports &lt;- 
  sports %&gt;% 
  `[`(1:15) %&gt;% 
  str_split(&quot;\\[&quot;) %&gt;% 
  map_chr(1)</code></pre>
<p>In the above [ is used ad prefix function for subsetting, rather than its usual usage object[index]. <code>purrr::map_chr</code> will select the first element of each vector and store the result in a single character vector. This part get the olympic event name list.</p>
<pre class="r"><code>medals &lt;- html_nodes(Olympics_2018_wiki, &quot;table&quot;) %&gt;%
  html_table() %&gt;% 
  `[`(3:26)</code></pre>
<p>For some reasons I checked manually that the 3rd up until the 26th table contain the results. Now, if you visit the wiki page you will notice that some sports have a single results table (such as Curling), while others have several (for women’s, for men’s, and some even for mixed events). I counted on the website the number of tables for each sport.</p>
<pre class="r"><code>tables_by_sport &lt;- c(3, 3, 1, 2, 1, 1, 2, 1, 1, 1, 2, 1, 1, 2, 2)</code></pre>
